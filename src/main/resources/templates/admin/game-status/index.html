<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게임 상태 관리</title>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <link rel="stylesheet" th:href="@{/admin-skin/css/admin-game-skin.css}">
</head>
<body>
<div class="container">
    <div class="header">
        <h1>🎮 게임 상태 관리</h1>
        <p>등록된 게임들의 승인 상태를 관리하고 검토할 수 있습니다.</p>
    </div>

    <!-- 🔍 디버깅 정보 (임시) -->
    <div style="background: #f0f0f0; padding: 15px; margin: 15px 0; border-radius: 8px;">
        <h4>🔍 디버깅 정보</h4>
        <p>notApprovedGame: <span th:text="${notApprovedGame != null}">false</span>
            (<span th:text="${notApprovedGame != null && notApprovedGame.gamesList != null ? notApprovedGame.gamesList.size() : 0}">0</span>개)</p>
        <p>approvedGame: <span th:text="${approvedGame != null}">false</span>
            (<span th:text="${approvedGame != null && approvedGame.gamesList != null ? approvedGame.gamesList.size() : 0}">0</span>개)</p>
        <p>underReviewGame: <span th:text="${underReviewGame != null}">false</span>
            (<span th:text="${underReviewGame != null && underReviewGame.gamesList != null ? underReviewGame.gamesList.size() : 0}">0</span>개)</p>
        <p>rejectedGame: <span th:text="${rejectedGame != null}">false</span>
            (<span th:text="${rejectedGame != null && rejectedGame.gamesList != null ? rejectedGame.gamesList.size() : 0}">0</span>개)</p>
        <p>suspendedGame: <span th:text="${suspendedGame != null}">false</span>
            (<span th:text="${suspendedGame != null && suspendedGame.gamesList != null ? suspendedGame.gamesList.size() : 0}">0</span>개)</p>
        <p>deactivatedGame: <span th:text="${deactivatedGame != null}">false</span>
            (<span th:text="${deactivatedGame != null && deactivatedGame.gamesList != null ? deactivatedGame.gamesList.size() : 0}">0</span>개)</p>
    </div>

    <!-- 탭 네비게이션 - 수정됨 -->
    <div class="nav-tabs">
        <button class="nav-tab active" onclick="showTab('pending')" id="tab-pending">
            🔍 미승인
            <span class="tab-badge" th:text="${notApprovedGame != null && notApprovedGame.gamesList != null ? notApprovedGame.gamesList.size() : 0}">0</span>
        </button>
        <button class="nav-tab" onclick="showTab('review')" id="tab-review">
            📋 검토중
            <span class="tab-badge" th:text="${underReviewGame != null && underReviewGame.gamesList != null ? underReviewGame.gamesList.size() : 0}">0</span>
        </button>
        <button class="nav-tab" onclick="showTab('approved')" id="tab-approved">
            ✅ 승인완료
            <span class="tab-badge" th:text="${approvedGame != null && approvedGame.gamesList != null ? approvedGame.gamesList.size() : 0}">0</span>
        </button>
        <button class="nav-tab" onclick="showTab('rejected')" id="tab-rejected">
            ❌ 거부됨
            <span class="tab-badge" th:text="${rejectedGame != null && rejectedGame.gamesList != null ? rejectedGame.gamesList.size() : 0}">0</span>
        </button>
        <button class="nav-tab" onclick="showTab('suspended')" id="tab-suspended">
            ⏸️ 정지됨
            <span class="tab-badge" th:text="${suspendedGame != null && suspendedGame.gamesList != null ? suspendedGame.gamesList.size() : 0}">0</span>
        </button>
        <button class="nav-tab" onclick="showTab('deactivated')" id="tab-deactivated">
            🔚 종료됨
            <span class="tab-badge" th:text="${deactivatedGame != null && deactivatedGame.gamesList != null ? deactivatedGame.gamesList.size() : 0}">0</span>
        </button>
    </div>

    <!-- 탭 컨텐츠 -->
    <div class="tab-content">
        <!-- 미승인 탭 (PENDING_REVIEW) -->
        <div class="tab-pane active" id="pending-pane">
            <div class="games-grid" th:if="${notApprovedGame != null && notApprovedGame.gamesList != null && !notApprovedGame.gamesList.isEmpty()}">
                <div class="game-card" th:each="game, iterStat : ${notApprovedGame.gamesList}">
                    <div class="game-header">
                        <div>
                            <div class="game-title" th:text="${game.gameName}">게임 이름</div>
                            <div class="game-team" th:text="${game.teamName}">제작팀</div>
                        </div>
                        <div class="status-indicator status-pending">PENDING</div>
                    </div>

                    <div class="game-info">
                        <div class="info-row">
                            <span class="info-label">장르:</span>
                            <span class="info-value" th:text="${game.genre}">액션</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">플랫폼:</span>
                            <span class="info-value" th:text="${game.platform}">PC</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">버전:</span>
                            <span class="info-value" th:text="${game.gameVersion}">1.0.0</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">등록일:</span>
                            <span class="info-value" th:text="${#temporals.format(game.createdAt, 'yyyy-MM-dd HH:mm')}">2024-01-01 10:00</span>
                        </div>
                    </div>

                    <div class="game-description" th:if="${game.gameDescription != null && !game.gameDescription.isEmpty()}">
                        <div th:text="${game.gameDescription}">게임 설명이 여기에 표시됩니다.</div>
                    </div>

                    <div class="actions">
                        <button class="btn btn-primary" onclick="moveToReview(this)" th:data-game-id="${game.gameId}">
                            🔍 검토 시작
                        </button>
                        <button class="btn btn-danger" onclick="rejectGame(this)" th:data-game-id="${game.gameId}">
                            ❌ 거부
                        </button>
                    </div>
                </div>
            </div>

            <div class="empty-state" th:if="${notApprovedGame == null || notApprovedGame.gamesList == null || notApprovedGame.gamesList.isEmpty()}">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
                <h3>검토 대기 중인 게임이 없습니다</h3>
                <p>새로운 게임이 등록되면 여기에 표시됩니다.</p>
            </div>
        </div>

        <!-- 검토중 탭 (UNDER_REVIEW) - 수정됨 -->
        <div class="tab-pane" id="review-pane">
            <div class="games-grid" th:if="${underReviewGame != null && underReviewGame.gamesList != null && !underReviewGame.gamesList.isEmpty()}">
                <div class="game-card" th:each="game, iterStat : ${underReviewGame.gamesList}">
                    <div class="game-header">
                        <div>
                            <div class="game-title" th:text="${game.gameName}">게임 이름</div>
                            <div class="game-team" th:text="${game.teamName}">제작팀</div>
                        </div>
                        <div class="status-indicator status-review">REVIEWING</div>
                    </div>

                    <div class="game-info">
                        <div class="info-row">
                            <span class="info-label">장르:</span>
                            <span class="info-value" th:text="${game.genre}">액션</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">플랫폼:</span>
                            <span class="info-value" th:text="${game.platform}">PC</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">등록일:</span>
                            <span class="info-value" th:text="${#temporals.format(game.createdAt, 'yyyy-MM-dd HH:mm')}">2024-01-01 10:00</span>
                        </div>
                    </div>

                    <div class="game-description" th:if="${game.gameDescription != null && !game.gameDescription.isEmpty()}">
                        <div th:text="${game.gameDescription}">게임 설명이 여기에 표시됩니다.</div>
                    </div>

                    <div class="actions">
                        <button class="btn btn-success" onclick="approveGame(this)" th:data-game-id="${game.gameId}">
                            ✅ 승인
                        </button>
                        <button class="btn btn-danger" onclick="rejectGame(this)" th:data-game-id="${game.gameId}">
                            ❌ 거부
                        </button>
                    </div>
                </div>
            </div>

            <div class="empty-state" th:if="${underReviewGame == null || underReviewGame.gamesList == null || underReviewGame.gamesList.isEmpty()}">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                </svg>
                <h3>검토 중인 게임이 없습니다</h3>
                <p>검토가 시작된 게임들이 여기에 표시됩니다.</p>
            </div>
        </div>

        <!-- 승인완료 탭 (ACTIVE) -->
        <div class="tab-pane" id="approved-pane">
            <div class="games-grid" th:if="${approvedGame != null && approvedGame.gamesList != null && !approvedGame.gamesList.isEmpty()}">
                <div class="game-card" th:each="game, iterStat : ${approvedGame.gamesList}">
                    <div class="game-header">
                        <div>
                            <div class="game-title" th:text="${game.gameName}">게임 이름</div>
                            <div class="game-team" th:text="${game.teamName}">제작팀</div>
                        </div>
                        <div class="status-indicator status-active">ACTIVE</div>
                    </div>

                    <div class="game-info">
                        <div class="info-row">
                            <span class="info-label">장르:</span>
                            <span class="info-value" th:text="${game.genre}">액션</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">플랫폼:</span>
                            <span class="info-value" th:text="${game.platform}">PC</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">승인일:</span>
                            <span class="info-value" th:text="${game.approvedAt != null ? #temporals.format(game.approvedAt, 'yyyy-MM-dd HH:mm') : 'N/A'}">2024-01-01 10:00</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">노출 상태:</span>
                            <span class="info-value" th:text="${game.isVisible() ? '👁️ 노출 중' : '🙈 숨김'}">👁️ 노출 중</span>
                        </div>
                    </div>

                    <div class="game-description" th:if="${game.gameDescription != null && !game.gameDescription.isEmpty()}">
                        <div th:text="${game.gameDescription}">게임 설명이 여기에 표시됩니다.</div>
                    </div>

                    <div class="actions">
                        <button class="btn btn-success" onclick="playGame(this)" th:data-game-id="${game.gameId}">
                            🎮 플레이하기
                        </button>
                        <button class="btn btn-warning" onclick="toggleVisibility(this)"
                                th:data-game-id="${game.gameId}"
                                th:data-visible="${game.isVisible()}"
                                th:text="${game.isVisible() ? '🙈 숨기기' : '👁️ 노출하기'}">
                            🙈 숨기기
                        </button>
                        <button class="btn btn-danger" onclick="suspendGame(this)" th:data-game-id="${game.gameId}">
                            ⏸️ 정지
                        </button>
                    </div>
                </div>
            </div>

            <div class="empty-state" th:if="${approvedGame == null || approvedGame.gamesList == null || approvedGame.gamesList.isEmpty()}">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                </svg>
                <h3>승인된 게임이 없습니다</h3>
                <p>승인된 게임들이 여기에 표시됩니다.</p>
            </div>
        </div>

        <!-- 거부됨 탭 (REJECTED) - 수정됨 -->
        <div class="tab-pane" id="rejected-pane">
            <div class="games-grid" th:if="${rejectedGame != null && rejectedGame.gamesList != null && !rejectedGame.gamesList.isEmpty()}">
                <div class="game-card" th:each="game, iterStat : ${rejectedGame.gamesList}">
                    <div class="game-header">
                        <div>
                            <div class="game-title" th:text="${game.gameName}">게임 이름</div>
                            <div class="game-team" th:text="${game.teamName}">제작팀</div>
                        </div>
                        <div class="status-indicator status-rejected">REJECTED</div>
                    </div>

                    <div class="game-info">
                        <div class="info-row">
                            <span class="info-label">장르:</span>
                            <span class="info-value" th:text="${game.genre}">액션</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">등록일:</span>
                            <span class="info-value" th:text="${#temporals.format(game.createdAt, 'yyyy-MM-dd HH:mm')}">2024-01-01 10:00</span>
                        </div>
                    </div>

                    <div class="actions">
                        <button class="btn btn-primary" onclick="moveToReview(this)" th:data-game-id="${game.gameId}">
                            🔄 재검토
                        </button>
                    </div>
                </div>
            </div>

            <div class="empty-state" th:if="${rejectedGame == null || rejectedGame.gamesList == null || rejectedGame.gamesList.isEmpty()}">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
                </svg>
                <h3>거부된 게임이 없습니다</h3>
                <p>거부된 게임들이 여기에 표시됩니다.</p>
            </div>
        </div>

        <!-- 정지됨 탭 (SUSPENDED) - 수정됨 -->
        <div class="tab-pane" id="suspended-pane">
            <div class="games-grid" th:if="${suspendedGame != null && suspendedGame.gamesList != null && !suspendedGame.gamesList.isEmpty()}">
                <div class="game-card" th:each="game, iterStat : ${suspendedGame.gamesList}">
                    <div class="game-header">
                        <div>
                            <div class="game-title" th:text="${game.gameName}">게임 이름</div>
                            <div class="game-team" th:text="${game.teamName}">제작팀</div>
                        </div>
                        <div class="status-indicator status-suspended">SUSPENDED</div>
                    </div>

                    <div class="game-info">
                        <div class="info-row">
                            <span class="info-label">장르:</span>
                            <span class="info-value" th:text="${game.genre}">액션</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">승인일:</span>
                            <span class="info-value" th:text="${game.approvedAt != null ? #temporals.format(game.approvedAt, 'yyyy-MM-dd HH:mm') : 'N/A'}">2024-01-01 10:00</span>
                        </div>
                    </div>

                    <div class="actions">
                        <button class="btn btn-success" onclick="reactivateGame(this)" th:data-game-id="${game.gameId}">
                            🔄 재활성화
                        </button>
                        <button class="btn btn-danger" onclick="deactivateGame(this)" th:data-game-id="${game.gameId}">
                            🔚 서비스 종료
                        </button>
                    </div>
                </div>
            </div>

            <div class="empty-state" th:if="${suspendedGame == null || suspendedGame.gamesList == null || suspendedGame.gamesList.isEmpty()}">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M14,19.14L15.41,20.55L20,16L15.41,11.45L14,12.86L16.17,15H4V17H16.17L14,19.14M10,4H22V6H10V4M10,7H22V9H10V7M10,10H22V12H10V10Z"/>
                </svg>
                <h3>정지된 게임이 없습니다</h3>
                <p>정지된 게임들이 여기에 표시됩니다.</p>
            </div>
        </div>

        <!-- 종료됨 탭 (DEACTIVATED) - 추가됨 -->
        <div class="tab-pane" id="deactivated-pane">
            <div class="games-grid" th:if="${deactivatedGame != null && deactivatedGame.gamesList != null && !deactivatedGame.gamesList.isEmpty()}">
                <div class="game-card" th:each="game, iterStat : ${deactivatedGame.gamesList}">
                    <div class="game-header">
                        <div>
                            <div class="game-title" th:text="${game.gameName}">게임 이름</div>
                            <div class="game-team" th:text="${game.teamName}">제작팀</div>
                        </div>
                        <div class="status-indicator status-deactivated">DEACTIVATED</div>
                    </div>

                    <div class="game-info">
                        <div class="info-row">
                            <span class="info-label">장르:</span>
                            <span class="info-value" th:text="${game.genre}">액션</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">승인일:</span>
                            <span class="info-value" th:text="${game.approvedAt != null ? #temporals.format(game.approvedAt, 'yyyy-MM-dd HH:mm') : 'N/A'}">2024-01-01 10:00</span>
                        </div>
                    </div>

                    <div class="game-description" th:if="${game.gameDescription != null && !game.gameDescription.isEmpty()}">
                        <div th:text="${game.gameDescription}">게임 설명이 여기에 표시됩니다.</div>
                    </div>

                    <div class="actions">
                        <span class="btn" style="background: #ccc; cursor: not-allowed;">🔚 서비스 종료됨</span>
                    </div>
                </div>
            </div>

            <div class="empty-state" th:if="${deactivatedGame == null || deactivatedGame.gamesList == null || deactivatedGame.gamesList.isEmpty()}">
                <svg fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M14.5,9L13.5,7.5C13.5,7.5 13.25,7 12.75,7C12.25,7 12,7.5 12,7.5L11,9H10V10H11V14H10V15H14V14H13V10H14.5V9Z"/>
                </svg>
                <h3>종료된 게임이 없습니다</h3>
                <p>서비스가 종료된 게임들이 여기에 표시됩니다.</p>
            </div>
        </div>
    </div>
</div>

<script th:src="@{/admin-skin/js/admin-game-skin.js}" defer></script>
</body>
</html>