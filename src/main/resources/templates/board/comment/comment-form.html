<!-- templates/fragments/comment-form.html -->
<div th:fragment="commentFormFragment">
    <!-- 로그인한 사용자에게만 댓글 폼 표시 -->
    <div th:if="${postDetail.reactType != null or postDetail.isAuthor}" class="comment-form-container">
        <form id="commentForm" method="post" th:action="@{/api/v1/posts/{postId}/comments(postId=${postDetail.posts.postId})}">
            <div class="comment-input-group">
                <textarea name="commentContent"
                          placeholder="댓글을 입력해주세요..."
                          rows="3"
                          required
                          maxlength="500"></textarea>
            </div>

            <input type="hidden" name="postId" th:value="${postDetail.posts.postId}">
            <input type="hidden" name="boardId" th:value="${postDetail.posts.board.boardId}">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

            <div class="comment-form-actions">
                <button type="submit" class="comment-submit-btn">댓글 등록</button>
            </div>
        </form>
    </div>

    <!-- 비로그인 사용자에게 메시지 표시 -->
    <div th:unless="${postDetail.reactType != null or postDetail.isAuthor}" class="login-required-message">
        <p>댓글을 작성하려면 <a href="/login">로그인</a>이 필요합니다.</p>
    </div>
</div>